import{d as O,$ as E,r as N,m as ee,n as G,S as g,T as y,c as a,a1 as s,a2 as e,z as u,a0 as k,Y as v,U as f,X as $,aI as te,E as T,W as b,V as M,aa as U,aP as ae,ab as le,a6 as A,ae as ne,a3 as F,a7 as oe,aQ as se,aR as ue,aS as de,aT as ie,aM as re,ai as B,ah as ce,y as me,Z as he}from"./index-ca172a6d.js";import{_ as R,a as K,F as pe}from"./numInput-e3011c2a.js";import"./index-7b457776.js";/* empty css              *//* empty css              */import{_ as z}from"./index-19d9e2dc.js";import"./index-3a5791df.js";import{t as fe,g as ge,C as be}from"./shortcut-e1cda134.js";import{a as _e}from"./functionalCallableComp-11e51ca8.js";const L="/infinite_image_browsing/fe-static/assets/sample-55dcafc6.webp",ke=["width","height","src"],ve=O({__name:"ImageSetting",setup(D){function l(S,r){return new Promise(h=>{const p=new Image;p.onload=()=>{const i=document.createElement("canvas");i.width=p.width*r,i.height=p.height*r,i.getContext("2d").drawImage(p,0,0,i.width,i.height),h(i.toDataURL())},p.src=S})}const d=E(),C=N("");return ee(()=>[d.enableThumbnail,d.gridThumbnailResolution],G(async()=>{d.enableThumbnail&&(C.value=await l(L,d.gridThumbnailResolution/1024))},300),{immediate:!0,deep:!0}),(S,r)=>{const h=K,p=z;return g(),y($,null,[a(h,{label:e(u)("defaultGridCellWidth")},{default:s(()=>[a(R,{min:64,max:1024,step:16,modelValue:e(d).defaultGridCellWidth,"onUpdate:modelValue":r[0]||(r[0]=i=>e(d).defaultGridCellWidth=i)},null,8,["modelValue"])]),_:1},8,["label"]),a(h,{label:e(u)("useThumbnailPreview")},{default:s(()=>[a(p,{checked:e(d).enableThumbnail,"onUpdate:checked":r[1]||(r[1]=i=>e(d).enableThumbnail=i)},null,8,["checked"])]),_:1},8,["label"]),e(d).enableThumbnail?(g(),k(h,{key:0,label:e(u)("thumbnailResolution")},{default:s(()=>[a(R,{modelValue:e(d).gridThumbnailResolution,"onUpdate:modelValue":r[2]||(r[2]=i=>e(d).gridThumbnailResolution=i),min:256,max:1024,step:64},null,8,["modelValue"])]),_:1},8,["label"])):v("",!0),a(h,{label:e(u)("livePreview")},{default:s(()=>[f("div",null,[f("img",{width:e(d).defaultGridCellWidth,height:e(d).defaultGridCellWidth,src:e(d).enableThumbnail?C.value:e(L)},null,8,ke)])]),_:1},8,["label"]),a(h,{label:e(u)("defaultShowChangeIndicators")},{default:s(()=>[a(p,{checked:e(d).defaultChangeIndchecked,"onUpdate:checked":r[3]||(r[3]=i=>e(d).defaultChangeIndchecked=i)},null,8,["checked"])]),_:1},8,["label"]),e(d).defaultChangeIndchecked?(g(),k(h,{key:1,label:e(u)("defaultSeedAsChange")},{default:s(()=>[a(p,{checked:e(d).defaultSeedChangeChecked,"onUpdate:checked":r[4]||(r[4]=i=>e(d).defaultSeedChangeChecked=i)},null,8,["checked"])]),_:1},8,["label"])):v("",!0),a(h,{label:e(u)("previewMaskBackgroundOpacity")},{default:s(()=>[a(R,{min:0,max:1,step:.05,modelValue:e(d).previewBgOpacity,"onUpdate:modelValue":r[5]||(r[5]=i=>e(d).previewBgOpacity=i)},null,8,["modelValue"])]),_:1},8,["label"])],64)}}}),Ce={class:"panel"},we={style:{"margin-top":"0"}},ye={class:"lang-select-wrap"},Se={class:"col"},Ie=O({__name:"globalSetting",setup(D){const l=E(),d=te(),C=N(!1),S=async()=>{window.location.reload()},r=[{value:"en",text:"English"},{value:"zhHans",text:"简体中文"},{value:"zhHant",text:"繁體中文"},{value:"de",text:"Deutsch"}],h=G(n=>{const t=l.shortcut[n];["ctrl","shift"].includes(t.toLowerCase())&&(l.shortcut[n]="")},700),p=fe(()=>{me.warn(u("notAllowSingleCtrlOrShiftAsShortcut"))},3e3),i=(n,t)=>{const m=ge(n);["ctrl","shift"].includes(m.toLowerCase())&&(p(),h(t)),m&&(l.shortcut[t]=m)},x=async()=>{await se("shutdown_api_server_command"),await ue.removeFile(de),await ie()},q=T(()=>[{value:"empty",text:u("emptyStartPage")},{value:"last-workspace-state",text:u("restoreLastWorkspaceState")},...d.snapshots.map(t=>({value:`workspace_snapshot_${t.id}`,text:u("restoreWorkspaceSnapshot",[t.name])}))]),V=T(()=>{const n=l.shortcut,t={};return Object.entries(n).forEach(([m,I])=>{var c;t[c=I+""]??(t[c]=0),t[I+""]++}),t}),H=T(()=>{var t;const n=[{key:"download",label:u("download")},{key:"delete",label:u("deleteSelected")}];return(t=l.conf)==null||t.all_custom_tags.forEach(m=>{n.push({key:`toggle_tag_${m.name}`,label:u("toggleTagSelection",{tag:m.name})})}),l.quickMovePaths.forEach(m=>{n.push({key:`copy_to_${m.dir}`,label:u("copyTo")+" "+m.zh})}),l.quickMovePaths.forEach(m=>{n.push({key:`move_to_${m.dir}`,label:u("moveTo")+" "+m.zh})}),n}),j=n=>n&&n in V.value&&V.value[n]>1;return(n,t)=>{var W;const m=re,I=B,c=K,w=z,Q=R,P=B,X=be,Y=ce,Z=pe;return g(),y("div",Ce,[(W=e(l).conf)!=null&&W.is_readonly?(g(),k(m,{key:0,message:n.$t("readonlyModeSettingPageDesc"),type:"warning"},null,8,["message"])):v("",!0),v("",!0),a(Z,null,{default:s(()=>[f("h2",we,b(e(u)("ImageBrowsingSettings")),1),a(ve),f("h2",null,b(e(u)("imgSearch")),1),a(c,{label:n.$t("rebuildImageIndex")},{default:s(()=>[a(I,{onClick:e(_e)},{default:s(()=>[M(b(n.$t("start")),1)]),_:1},8,["onClick"])]),_:1},8,["label"]),f("h2",null,b(e(u)("autoRefresh")),1),a(c,{label:n.$t("autoRefreshWalkMode")},{default:s(()=>[a(w,{checked:e(l).autoRefreshWalkMode,"onUpdate:checked":t[0]||(t[0]=o=>e(l).autoRefreshWalkMode=o)},null,8,["checked"])]),_:1},8,["label"]),a(c,{label:n.$t("autoRefreshNormalFixedMode")},{default:s(()=>[a(w,{checked:e(l).autoRefreshNormalFixedMode,"onUpdate:checked":t[1]||(t[1]=o=>e(l).autoRefreshNormalFixedMode=o)},null,8,["checked"])]),_:1},8,["label"]),a(c,{label:e(u)("autoRefreshWalkModePosLimit")},{default:s(()=>[a(Q,{min:0,max:1024,step:16,modelValue:e(l).autoRefreshWalkModePosLimit,"onUpdate:modelValue":t[2]||(t[2]=o=>e(l).autoRefreshWalkModePosLimit=o)},null,8,["modelValue"])]),_:1},8,["label"]),f("h2",null,b(e(u)("other")),1),a(c,{label:n.$t("lang")},{default:s(()=>[f("div",ye,[a(e(U),{options:r,value:e(l).lang,"onUpdate:value":t[3]||(t[3]=o=>e(l).lang=o),onChange:t[4]||(t[4]=o=>C.value=!0)},null,8,["value"])]),C.value?(g(),k(P,{key:0,type:"primary",onClick:S,ghost:""},{default:s(()=>[M(b(e(u)("langChangeReload")),1)]),_:1})):v("",!0)]),_:1},8,["label"]),a(c,{label:n.$t("onlyFoldersAndImages")},{default:s(()=>[a(w,{checked:e(l).onlyFoldersAndImages,"onUpdate:checked":t[5]||(t[5]=o=>e(l).onlyFoldersAndImages=o)},null,8,["checked"])]),_:1},8,["label"]),a(c,{label:n.$t("showCommaInGenInfoPanel")},{default:s(()=>[a(w,{checked:e(l).showCommaInInfoPanel,"onUpdate:checked":t[6]||(t[6]=o=>e(l).showCommaInInfoPanel=o)},null,8,["checked"])]),_:1},8,["label"]),a(c,{label:n.$t("defaultSortingMethod")},{default:s(()=>[a(e(U),{value:e(l).defaultSortingMethod,"onUpdate:value":t[7]||(t[7]=o=>e(l).defaultSortingMethod=o),conv:e(ae),options:e(le)},null,8,["value","conv","options"])]),_:1},8,["label"]),a(c,{label:n.$t("longPressOpenContextMenu")},{default:s(()=>[a(w,{checked:e(l).longPressOpenContextMenu,"onUpdate:checked":t[8]||(t[8]=o=>e(l).longPressOpenContextMenu=o)},null,8,["checked"])]),_:1},8,["label"]),a(c,{label:n.$t("openOnAppStart")},{default:s(()=>[a(e(U),{value:e(l).defaultInitinalPage,"onUpdate:value":t[9]||(t[9]=o=>e(l).defaultInitinalPage=o),options:q.value},null,8,["value","options"])]),_:1},8,["label"]),(g(!0),y($,null,A(e(l).ignoredConfirmActions,(o,_)=>(g(),k(c,{label:n.$t(_+"SkipConfirm"),key:_},{default:s(()=>[a(X,{checked:e(l).ignoredConfirmActions[_],"onUpdate:checked":J=>e(l).ignoredConfirmActions[_]=J},null,8,["checked","onUpdate:checked"])]),_:2},1032,["label"]))),128)),f("h2",null,b(e(u)("shortcutKey")),1),(g(!0),y($,null,A(H.value,o=>(g(),k(c,{label:o.label,key:o.key},{default:s(()=>[f("div",{class:ne(["col",{conflict:j(e(l).shortcut[o.key]+"")}]),onKeydown:t[10]||(t[10]=F(()=>{},["stop","prevent"]))},[a(Y,{value:e(l).shortcut[o.key],onKeydown:F(_=>i(_,o.key),["stop","prevent"]),placeholder:n.$t("shortcutKeyDescription")},null,8,["value","onKeydown","placeholder"]),a(P,{onClick:_=>e(l).shortcut[o.key]="",class:"clear-btn"},{default:s(()=>[M(b(n.$t("clear")),1)]),_:2},1032,["onClick"])],34)]),_:2},1032,["label"]))),128)),e(oe)?(g(),y($,{key:0},[f("h2",null,b(e(u)("clientSpecificSettings")),1),a(c,null,{default:s(()=>[f("div",Se,[a(P,{onClick:x,class:"clear-btn"},{default:s(()=>[M(b(n.$t("initiateSoftwareStartupConfig")),1)]),_:1})])]),_:1})],64)):v("",!0)]),_:1})])}}});const Ae=he(Ie,[["__scopeId","data-v-1a3e2b48"]]);export{Ae as default};
